<!-- 
  VISTA DE RESTABLECIMIENTO DE CONTRASEÑA.
  Esta plantilla gestiona el último paso del flujo de recuperación. 
  Permite al usuario definir una nueva contraseña tras validar su identidad 
  mediante el token enviado por correo electrónico.
-->

<div class="reset-container">
  
  <!-- Fondo decorativo -->
  <div class="background-overlay"></div>

  <div class="card">
    
    <!-- HEADER ESTILO SPOTIFY -->
    <header class="card-header">
      <div class="icon-circle">
        <!-- Icono Candado/Llave -->
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
      </div>
      <h2>Restablecer Contraseña</h2>
      <p class="subtitle">Crea una nueva clave segura para tu cuenta</p>
    </header>

    <!-- FORMULARIO -->
    <div class="form-content">
      
      <!-- CAMPO: EMAIL (SOLO LECTURA)
           Se muestra deshabilitado ya que el email se recupera automáticamente 
           del token de la URL para evitar suplantaciones.
      -->
      <div class="input-group">
        <label for="email">Email</label>
        <div class="input-wrapper">
          <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
          <input
            id="email"
            type="email"
            [(ngModel)]="email"
            disabled
            class="input-disabled"
          />
        </div>
      </div>

      <!-- CAMPO: NUEVA CONTRASEÑA -->
      <div class="input-group">
        <label for="pwd1">Nueva contraseña</label>
        <div class="input-wrapper">
          <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
          <input
            id="pwd1"
            type="password"
            [(ngModel)]="newPwd"
            placeholder="Mínimo 8 caracteres"
          />
        </div>
      </div>

      <!-- CAMPO: CONFIRMACIÓN -->
      <div class="input-group">
        <label for="pwd2">Repite la contraseña</label>
        <div class="input-wrapper">
          <!-- Icono de verificación de éxito visual -->
          <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
          <input
            id="pwd2"
            type="password"
            [(ngModel)]="repeatPwd"
            placeholder="Confirma tu nueva clave"
          />
        </div>
      </div>

      <!-- BOTÓN DE GUARDADO -->
      <button
        class="btn-primary"
        type="button"
        (click)="changePassword()"
        [disabled]="loading"
      >
      <!-- El botón alterna entre texto y el SPINNER de carga documentado en el CSS -->
        <span *ngIf="!loading">Guardar Contraseña</span>
        <span *ngIf="loading" class="spinner"></span>
      </button>

      <!-- Mensajes -->
      <div class="message-container">
        <p *ngIf="msg" class="msg success">{{ msg }}</p>
        <p *ngIf="err" class="msg error">{{ err }}</p>
      </div>

    </div>
  </div>
</div>